<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Static Site Generator</title>
  <style>
    /* RESET & BASE */
    * { box-sizing:border-box; }
    body {
      margin:0; padding:0;
      font-family: 'Segoe UI', sans-serif;
      background: #f0f2f5;
      color: #333;
    }
    header {
      padding: 20px;
      text-align: center;
    }
    h1 { margin: 0 0 10px; font-size: 2rem; color: #2c3e50; }
    p.subtitle { margin:0; color: #555; }

    /* LAYOUT */
    .wrapper {
      display: flex;
      justify-content: center;
      gap: 20px;
      padding: 10px 20px 20px;
    }
    .form-section {
      flex: 2;
      background: #fff;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      padding: 20px;
      overflow-y: auto;
      /* subtract header height + padding: ~120px */
      max-height: calc(100vh - 120px);
    }
    .preview-section {
      width: 375px;
      position: sticky;
      top: 80px; /* sticks below header */
      background: #fff;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      display: flex;
      flex-direction: column;
      overflow: hidden;
      /* same vertical space as form */
      max-height: calc(100vh - 120px);
    }

    /* FORM STYLES */
    .form-group { margin-bottom: 15px; }
    label {
      display: block;
      margin-bottom: 5px;
      font-weight: bold;
    }
    input, textarea {
      width: 100%;
      padding: 8px;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 1rem;
    }
    textarea { resize: vertical; min-height: 80px; }
    .char-counter {
      font-size: 0.85rem;
      color: #666;
      text-align: right;
    }
    .warning { color: #c00; }

    /* SUBMIT */
    .action-buttons {
      text-align: right;
      margin-top: 20px;
    }
    button.submit-button {
      background: #007bff;
      color: #fff;
      border: none;
      padding: 10px 20px;
      border-radius: 4px;
      font-size: 1rem;
      cursor: pointer;
    }
    button.submit-button:hover {
      background: #0069d9;
    }

    /* PREVIEW */
    .preview-header {
      padding: 10px 15px;
      border-bottom: 1px solid #eee;
      font-weight: bold;
      background: #fafafa;
    }
    #preview {
      flex: 1;
      border-top: none;
      overflow: hidden; /* iframe fills it exactly */
    }
    #preview iframe {
      width: 100%;
      height: 100%;
      border: 0;
    }

    /* SMALL SCREENS */
    @media (max-width: 992px) {
      .wrapper { flex-direction: column; }
      .form-section, .preview-section {
        max-height: none;
        position: relative;
        top: 0;
        width: 100%;
        margin-bottom: 20px;
      }
      .preview-section { height: 50vh; }
    }
  </style>
</head>
<body>
  <header>
    <h1>Static Site Generator</h1>
    <p class="subtitle">Fill out the form and watch the live preview. When you’re ready, click Submit.</p>
  </header>

  <div class="wrapper">
    <div class="form-section">
      <h2>Content Form</h2>
      <form id="contentForm" action="https://formspree.io/f/xjvqvrvg" method="POST">
        <!-- JS will inject all your fields here -->
        <div class="action-buttons">
          <button type="submit" class="submit-button">Submit</button>
        </div>
      </form>
    </div>

    <div class="preview-section">
      <div class="preview-header">Preview</div>
      <div id="preview"><p style="padding:20px;color:#888;">Loading…</p></div>
    </div>
  </div>

  <script>
    // fallback sample template
    const sampleTemplate = `
<!DOCTYPE html>
<html><head><meta charset="utf-8"><title>{{siteTitle}}</title></head>
<body style="font-family:sans-serif;padding:20px;">
  <h1 style="color:{{accentColor}}">{{bigIntro}}</h1>
  <p>{{smallIntro}}</p>
  <p>{{topLocation}}</p>
</body></html>`;

    let template = '';

    async function loadTemplate() {
      try {
        const res = await fetch('template.html');
        template = res.ok ? await res.text() : sampleTemplate;
      } catch {
        template = sampleTemplate;
      }
    }

    // Only these fields (we removed the ones you asked)
    const fields = [
      { name:'siteTitle',     label:'Site Title',                  max:50 },
      { name:'bigIntro',      label:'Big Intro',                   max:50 },
      { name:'smallIntro',    label:'Small Intro',                 max:160 },
      { name:'topLocation',   label:'Location (Denver, Colorado)', max:30 },
      { name:'aboutHeader',   label:'About Section Header',        max:45 },
      { name:'aboutTitle',    label:'About Section Title',         max:60 },
      { name:'aboutText',     label:'About Text',                  max:600, type:'textarea' },
      // …add the rest exactly as you need…
      { name:'accentColor',   label:'Accent Color',               max:7,   type:'color' }
    ];

    function buildForm() {
      const form = document.getElementById('contentForm');
      const submitGroup = form.querySelector('.action-buttons');

      fields.forEach(def => {
        const group = document.createElement('div');
        group.className = 'form-group';

        const lbl = document.createElement('label');
        lbl.htmlFor = def.name;
        lbl.textContent = `${def.label} (max ${def.max})`;
        group.appendChild(lbl);

        const inp = def.type==='textarea'
          ? document.createElement('textarea')
          : document.createElement('input');
        if (inp.tagName==='INPUT') inp.type = def.type==='color' ? 'color' : 'text';
        inp.id = inp.name = def.name;
        inp.maxLength = def.max;
        if (def.type==='color') inp.value = '#007bff';

        group.appendChild(inp);

        const counter = document.createElement('div');
        counter.className = 'char-counter';
        counter.innerHTML = `<span id="${def.name}Count">0</span>/${def.max}`;
        group.appendChild(counter);

        form.insertBefore(group, submitGroup);

        inp.addEventListener('input', () => {
          const cnt = document.getElementById(def.name+'Count');
          cnt.textContent = inp.value.length;
          cnt.classList.toggle('warning', inp.value.length > def.max*0.8);
          renderPreview();
        });
      });
    }

    function renderPreview() {
      const data = new FormData(document.getElementById('contentForm'));
      // inject a small style so pale templates still show text
      let html = template.replace(
        /<head(\b[^>]*)>/i,
        `<head$1><style>body{color:#333!important}</style>`
      );
      html = html.replace(/{{\s*([\w]+)\s*}}/g, (_,key) => data.get(key) || '');
      document.getElementById('preview').innerHTML =
        `<iframe srcdoc="${html.replace(/"/g,'&quot;')}"></iframe>`;
    }

    (async() => {
      await loadTemplate();
      buildForm();
      renderPreview();
    })();
  </script>
</body>
</html>
